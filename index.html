<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Playlist mit Player und Sidebar</title>
<style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        align-items: stretch;
        min-height: 100vh;
        margin: 0;
    }
    .sidebar {
        width: 250px;
        background-color: #f0f0f0;
        padding: 20px;
    }
    .player-container {
        flex-grow: 1;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #player {
        width: 80%;
        max-width: 800px;
    }
    .playlist-item {
        cursor: pointer;
        padding: 5px 0;
    }
</style>
</head>
<body>
    <div class="sidebar">
        <h2>Sender</h2>
        <div id="playlist">
            <!-- Hier werden die Sender dynamisch hinzugefügt -->
        </div>
    </div>
    <div class="player-container">
        <audio id="player" controls>
            Ihr Browser unterstützt keine Audioelemente.
        </audio>
    </div>

    <script>
        // M3U-URL zur Liste der Sender
        const m3uURL = 'https://raw.githubusercontent.com/gambler65/kongresi1908/e02c87c13cca9a31a602ca16f92c996c4021df8f/satlok.m3u';

        // Funktion zur Konvertierung von HTTP zu HTTPS für URLs
        function convertToHttps(url) {
            if (url.startsWith('http://')) {
                return url.replace('http://', 'https://');
            }
            return url;
        }

        // Laden und Verarbeiten der M3U-Datei
        fetch(m3uURL)
            .then(response => response.text())
            .then(data => {
                const playlistContainer = document.getElementById('playlist');
                playlistContainer.innerHTML = ''; // Leeren der Playlist

                // Teile die M3U-Datei in Blöcke auf
                const blocks = data.trim().split('\n\n');

                // Durchlaufe jeden Block in der M3U-Datei
                blocks.forEach(block => {
                    const lines = block.trim().split('\n');
                    let tvgName = '';
                    let tvgLogo = '';
                    let channelUrl = '';

                    lines.forEach(line => {
                        const trimmedLine = line.trim();

                        // Extrahiere tvg-name aus #EXTINF Zeilen
                        if (trimmedLine.startsWith('#EXTINF:')) {
                            const tvgNameMatch = trimmedLine.match(/tvg-name="([^"]+)"/);
                            if (tvgNameMatch) {
                                tvgName = tvgNameMatch[1];
                            } else {
                                const lastCommaIndex = trimmedLine.lastIndexOf(',');
                                if (lastCommaIndex !== -1) {
                                    tvgName = trimmedLine.substring(lastCommaIndex + 1).trim();
                                } else {
                                    tvgName = 'Unbekannter Sender';
                                }
                            }
                        }

                        // Extrahiere tvg-logo aus #EXTINF Zeilen
                        if (trimmedLine.startsWith('#EXTINF:')) {
                            const tvgLogoMatch = trimmedLine.match(/tvg-logo="([^"]+)"/);
                            if (tvgLogoMatch) {
                                tvgLogo = tvgLogoMatch[1];
                            }
                        }

                        // Extrahiere Sender-URL
                        if (!trimmedLine.startsWith('#')) {
                            channelUrl = convertToHttps(trimmedLine);
                        }
                    });

                    // Erstelle ein Playlist-Element in der Sidebar
                    const playlistItem = document.createElement('div');
                    playlistItem.className = 'playlist-item';
                    playlistItem.textContent = tvgName;
                    playlistItem.addEventListener('click', () => {
                        document.getElementById('player').src = channelUrl;
                        document.getElementById('player').play();
                    });
                    playlistContainer.appendChild(playlistItem);
                });
            })
            .catch(error => console.error('Fehler beim Laden der M3U-Datei:', error));
    </script>
</body>
</html>
